<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      font-family: Arial;
      padding: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: center;
    }
    th {
      background-color: #4CAF50;
      color: white;
    }
    button {
      padding: 6px 12px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <h2 id="deptTitle">Book Catalogue</h2>
  <table id="bookTable">
    <tr>
      <th>Title</th>
      <th>Author</th>
      <th>Publisher</th>
      <th>Price (â‚¹)</th>
      <th>Action</th>
    </tr>
  </table>

 <script>
  const booksByDept = {
    CSE: [
      { title: "Artificial Intelligence", author: "S. Russel", publisher: "Princeton", price: 63 },
      { title: "Java 2", author: "Watson", publisher: "BPB", price: 35.5 },
    ],
    ECE: [
      { title: "DSP", author: "Proakis", publisher: "McGraw Hill", price: 70 }
    ],
    EEE: [
      { title: "Electrical Machines", author: "Nagrath", publisher: "TMH", price: 55 }
    ],
    CIVIL: [
      { title: "Concrete Structures", author: "Jain", publisher: "Pearson", price: 80 }
    ]
  };

  
  if (!localStorage.getItem('books')) {
    localStorage.setItem('books', JSON.stringify(booksByDept));
  }

  if (!localStorage.getItem('cart')) {
    localStorage.setItem('cart', JSON.stringify([]));
  }

  function renderBooks(dept) {
    const allBooks = JSON.parse(localStorage.getItem('books'));
    const books = allBooks[dept] || [];

    document.getElementById('deptTitle').textContent = dept + " Department Books";

    const table = document.getElementById('bookTable');
    table.querySelectorAll('tr:not(:first-child)').forEach(row => row.remove());

    books.forEach((book, index) => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${book.title}</td>
        <td>${book.author}</td>
        <td>${book.publisher}</td>
        <td>${book.price}</td>
        <td><button onclick='addToCart(${JSON.stringify(book)})'>Add to Cart</button></td>
      `;
      table.appendChild(row);
    });
  }

  function addToCart(book) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart.push(book);
    localStorage.setItem('cart', JSON.stringify(cart));
    alert(`Added "${book.title}" to cart!`);
  }

  window.addEventListener('message', (event) => {
    if (event.data && event.data.department) {
      renderBooks(event.data.department);
    }
  });

  renderBooks('CSE');
</script>

</body>
</html>
